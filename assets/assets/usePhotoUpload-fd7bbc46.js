import{n as h,o as k,an as j,$ as U,Z as w}from"./vendor-base-cc18fcff.js";import{z as E,a6 as M,J as N,s as T}from"./shared-4873712f.js";import"./index-6524c7ed.js";import{u as P}from"./useS3Upload-00eba9e8.js";const z={event:"blue",service:"green",property:"orange"},$=()=>{const{getIntlText:t}=E();return h.useMemo(()=>[{title:t("mg.product.list.table_title_function"),dataIndex:"function",key:"function",width:"12%",render(o){return k.jsx(j,{size:"small",type:"simple",color:z[o]||"gray",children:o})}},{title:t("common.label.name"),dataIndex:"name",key:"name",width:"15%",ellipsis:!0},{title:t("mg.product.info.prop_identification"),dataIndex:"identification",key:"identification",width:"15%",ellipsis:!0},{title:t("mg.product.list.table_title_parameter_id"),dataIndex:"parameterId",key:"parameterId",width:"15%",ellipsis:!0},{title:t("mg.product.list.table_title_data"),dataIndex:"dataType",key:"dataType",ellipsis:!0,width:"8%"},{title:t("mg.product.list.table_title_value_definition"),dataIndex:"unitName",key:"unitName",width:"18%"},{title:t("mg.product.list.table_title_read_or_write"),dataIndex:"accessMode",key:"accessMode",align:"center",width:"10%",render(o){const s=M.find(m=>m.value===o);return s?t(s==null?void 0:s.labelIntlKey):o}}],[t])},D=({data:t,..._})=>{const u=h.useCallback(({properties:a,events:i,services:y})=>{const d=[];return a==null||a.forEach(({id:r,name:p,accessMode:l,dataSpec:e})=>{d.push({id:r,name:p,accessMode:l,identification:r,dataType:e==null?void 0:e.dataType,unitName:e==null?void 0:e.unitName,function:"property"})}),i==null||i.forEach(({id:r,name:p,outputs:l})=>{l==null||l.forEach(e=>{const{id:g,dataSpec:n}=e;d.push({id:r,name:p,identification:r,parameterId:g,dataType:n==null?void 0:n.dataType,unitName:n==null?void 0:n.unitName,function:"event"})})}),y==null||y.forEach(({id:r,name:p,inputs:l=[],outputs:e=[]})=>{[...l,...e].forEach(g=>{const{id:n,dataSpec:f}=g;d.push({id:r,name:p,identification:r,parameterId:n,dataType:f==null?void 0:f.dataType,unitName:f==null?void 0:f.unitName,function:"service"})})}),d},[]),o=h.useMemo(()=>{const a=[];return t==null||t.forEach(i=>{a.push(...u(i))}),a},[t,u]),[s,m]=h.useState({total:o==null?void 0:o.length,current:1,pageSize:10,showLessItems:!0}),x=({current:a,pageSize:i})=>{m({...s,current:a,pageSize:i})};return k.jsx(N,{name:"table-product-model",rowKey:a=>`${a.id}-${a.parameterId||""}`,columnsSetup:!1,pagination:s,dataSource:o,onChange:x,..._})},K=t=>{const{getIntlText:_}=E(),[u,o]=U(t),[s,m]=h.useState([]),[x,a]=h.useState(""),{s3UploadRequest:i}=P({moduleName:"device"}),{accept:y=[".jpg",".png"],maxSize:d=10*1024*1024}=t,r=e=>{const{size:g}=e,n=y.map(c=>c.replace(".",""));if(!(n.some(c=>/jpe?g/.test(c))?new RegExp([...n,"jpg","jpeg"].join("|")):new RegExp(n.join("|"))).test(e.type))return w.error(_("common.upload.message_image_format_incorrect",{1:`"${n.map(c=>c.replace(".","")).join("/")}"`})),!1;if(g>d)return w.error(_("common.upload.message_image_size_exceed_limit",{1:Math.floor(d/(1024*1024))})),!1;const I=new FileReader;return I.readAsDataURL(e),I.onload=c=>{var b;a((b=c==null?void 0:c.target)==null?void 0:b.result)},!0},p=T(({file:e})=>{const{status:g,url:n}=e;switch(g){case"error":{m([e]),a("");break}case"uploading":{m([e]);break}case"removed":{o("");break}case"done":{a(""),n&&o(n);break}}}),l=T(()=>{o("")});return h.useLayoutEffect(()=>{m(u?[{uid:"-1",name:"",status:"done",url:u}]:[])},[u]),{accept:y.join(","),photoUrl:u,fileList:s,photoPreviewUrl:x,handleBeforeUpload:r,s3UploadRequest:i,handleUploadChange:p,handleUploadRemove:l}};export{D as M,$ as a,K as u};
