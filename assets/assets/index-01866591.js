import{q as K,n as o,ar as q,o as n,B as F,I as M,i as C,x as _}from"./vendor-base-cc18fcff.js";import{p as G}from"./index-6524c7ed.js";import{u as J,P as L}from"./useColumns-31cfb7a0.js";import"./style-pages-42a62cad.js";import{z as O,q as V,s as $,J as H,C as Q}from"./shared-4873712f.js";import"./vendor-c76f9059.js";import"./__commonjsHelpers__-23102255.js";import"./i18n-helper-ef5bc359.js";/* empty css                     */import"./style-shared-6740825f.js";const U={ascend:"asc",descend:"desc"},re=()=>{const l=K(),{lang:R,getIntlText:u}=O(),[d,k]=o.useState(""),[p,E]=o.useState(!0),[s,c]=o.useState({total:0,current:1,pageSize:10}),[a,P]=o.useState({}),[r,w]=o.useState({}),{data:m,loading:g,run:y}=q(async()=>{var i;const e=a.columnKey?[{property:a.columnKey,direction:a.order&&U[a.order]}]:void 0,t=await G.getProducts({pageSize:s.pageSize,pageNumber:s.current,deviceType:r.deviceType,snIdentification:(i=r.snIdentification)!=null&&i.length?r.snIdentification[0]:null,sorts:e,keyword:d});return V(t)},{refreshDeps:[s.current,s.pageSize,a,r,d,R],onSuccess(e){p&&(e!=null&&e.total)&&E(!1),c({...s,total:(e==null?void 0:e.total)||0})}}),b=o.useMemo(()=>n.jsx(F,{type:"primary",onClick:()=>l("/product/add"),suffix:n.jsx(M,{type:"icon-add"}),children:u("common.label.add")}),[l,u]),[x,f]=o.useState(null),S=$((e,t)=>{switch(e){case"detail":{l(`/product/detail/${t.id}`,{state:t});break}case"publish":{f(t);break}}}),z=J({filteredInfo:r,onButtonClick:S}),B=(e,t,i)=>{const{current:N,pageSize:A}=e,v=Array.isArray(i)?i[0]:i;P(v.order?v:{}),w(!t||Object.entries(t).every(([,D])=>!D)?{}:t),c({...s,current:N,pageSize:A})},T=(e,t)=>{if(e===1&&t===10&&e===s.current&&t===s.pageSize){y();return}c({...s,current:1,pageSize:10})},I=!C(r)||!C(a)||d,h=g&&!I&&p,j=g===!1&&!I&&p;return n.jsxs("div",{className:"ms-main ms-main-full ms-main-product",children:[n.jsx(H,{showGlobalSearch:!0,name:"table-product",rowKey:"id",scroll:{x:"max-content"},loading:g&&!h,toolbarRender:b,pagination:s,columns:z,dataSource:m==null?void 0:m.content,onChange:B,onRefresh:T,onGlobalSearchChange:e=>{k(e),c({...s,current:1})},onRow:e=>({onDoubleClick:()=>S("detail",e)})}),(h||j)&&n.jsx(_,{spinning:h,className:"ms-product-block-placeholder",children:j&&n.jsx("div",{className:"ms-product-empty",children:n.jsx(Q,{text:u("mg.product.list.table_no_data_tip"),extra:b})})}),n.jsx(L,{visible:!!x,data:x,onSuccess:()=>{y(),f(null)},onCancel:()=>f(null)})]})};export{re as default};
