import{q as _,n as u,o as m,aE as F,j as q,ar as B,p as P,i as V}from"./vendor-base-cc18fcff.js";import{u as G}from"./index-6524c7ed.js";import{z as v,A as O,aj as j,q as J,a7 as $,J as H}from"./shared-4873712f.js";import"./style-pages-42a62cad.js";import"./vendor-c76f9059.js";import"./__commonjsHelpers__-23102255.js";import"./i18n-helper-ef5bc359.js";/* empty css                     */import"./style-shared-6740825f.js";const Q=({filteredInfo:l,regionValue:n})=>{const{getIntlText:a}=v(),{getSysTimeFormat:s}=O(),o=_();return u.useMemo(()=>[{title:a("account.my.account_title"),dataIndex:"account",key:"account",width:379,ellipsis:!0,render:(r,c)=>{const{name:t,email:p}=c||{};return m.jsxs("div",{children:[m.jsx("div",{className:"user-store-name",children:t}),m.jsx("div",{className:"user-store-email",children:p})]})}},{title:a("account.register.company_name"),dataIndex:"companyName",key:"companyName",width:297,ellipsis:!0,filterSearchType:"search",filteredValue:l.companyName||null},{title:a("common.label.device"),dataIndex:"device",key:"device",width:228,ellipsis:!0,render:r=>{const c=t=>{t.preventDefault(),o("/device",{state:{userId:r,serverRegion:n}})};return m.jsx("a",{onClick:c,children:r})}},{title:a("mg.user.registration_method"),dataIndex:"registerMethod",key:"registerMethod",width:284,ellipsis:!0,filters:j.map(({labelIntlKey:r,value:c})=>({text:a(r),value:c})),filteredValue:l.registerMethod||null,render:r=>{const c=j.find(t=>t.value===r);return c?a(c.labelIntlKey):null}},{title:a("mg.user.registration_time"),dataIndex:"registrationTime",key:"registrationTime",width:171,ellipsis:!0,render:r=>r?s(r,"fullDateTimeSecondFormat"):null}],[a,s,l,o,n])},W=Q,X=()=>{const l=s=>{if(!s||!Array.isArray(s))return s;const[o]=s||[];return o},n=s=>{if(!s)return s;const o={};return Object.keys(s).forEach(d=>{const r=s[d];o[d]=l(r)}),o};return{getSearchValue:s=>{if(!s)return{};const{companyName:o,registerMethod:d}=n(s),r={companyName:o,registerMethod:d},c=t=>Array.isArray(t)?!t.length:q(t);return F(r,t=>!c(t))}}},Y={ascend:"asc",descend:"desc"},Z=()=>({getSortValue:n=>{if(n!=null&&n.columnKey)return[{property:n.columnKey,direction:n.order&&Y[n.order]}]}}),le=()=>{const{getIntlText:l,lang:n}=v(),[a,s]=u.useState(""),[o,d]=u.useState(!0),[r,c]=u.useState("CN"),[t,p]=u.useState({total:0,current:1,pageSize:10}),[y,C]=u.useState({}),[h,R]=u.useState({}),{getSortValue:T}=Z(),{getSearchValue:w}=X(),{data:S,loading:b,run:k}=B(async()=>{const e=T(y),i=w(h),{pageSize:g,current:x}=t||{},f=await G.getUserList({keyword:a,sorts:e,pageSize:g,pageNumber:x,region:r,...i});return J(f)},{refreshDeps:[t.current,t.pageSize,y,h,a,n,r],onSuccess(e){o&&(e!=null&&e.total)&&d(!1),p({...t,total:(e==null?void 0:e.total)||0})}}),M=W({filteredInfo:h,regionValue:r}),A=(e,i,g)=>{const{current:x,pageSize:f}=e,N=Array.isArray(g)?g[0]:g;C(N.order?N:{}),R(!i||Object.entries(i).every(([,L])=>!L)?{}:i),p({...t,current:x,pageSize:f})},E=(e,i)=>{if(e===1&&i===10&&e===t.current&&i===t.pageSize){k();return}p({...t,current:1,pageSize:10})},z=e=>{c(e==null?void 0:e.toLocaleUpperCase())},I=u.useMemo(()=>$.filter(e=>["CN","US"].includes(e.value.toUpperCase())).map(e=>{var i;return{value:((i=e.value)==null?void 0:i.toLocaleUpperCase())||"",label:l(e.labelIntlKey||""),className:"ms-region-select-item"}}),[l]),D=u.useMemo(()=>m.jsx("div",{className:"user-store-toolbar",children:m.jsx(P,{value:r,onChange:z,options:I})}),[I,r]),K=!V(h)||!V(y)||a,U=b&&!K&&o;return m.jsx("div",{className:"ms-main ms-main-full ms-main-user-store",children:m.jsx(H,{showGlobalSearch:!0,name:"table-user-store",rowKey:"userId",scroll:{x:"max-content"},loading:b&&!U,pagination:t,columns:M,toolbarRender:D,dataSource:S==null?void 0:S.content,onChange:A,onRefresh:E,onGlobalSearchChange:e=>{s(e),p({...t,current:1})}})})};export{le as default};
